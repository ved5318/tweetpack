version: 1.0

description: A Workflow to create ubuntu vm using template.

input:
  - username
  - consumer_key
  - consumer_secret
  - access_key
  - access_secret
  - text

vars:
  - result: ''

tasks:    


  get_tweets:
    action: tweetpack.fetch
    input:
      username: <% ctx().username %>
      consumer_key: <% ctx().consumer_key %>
      consumer_secret: <% ctx().consumer_secret %>
      access_key: <% ctx().access_key %>
      access_secret: <% ctx().access_secret %>
      
      timeout: 3600
    next:
      - when: <% succeeded() %>
        publish:
          - result: "{{ result() }}"
        do:
          - done
      - when: <% failed() %>
        publish:
          - result: "{{ result() }}"
        do:
          - failed 
  send_tweets:
    action: tweetpack.send
    input:
      text: <% task(get_tweets).result.result%>
      
      timeout: 3600
    next:
      - when: <% succeeded() %>
        publish:
          - result: "{{ result() }}"
        do:
          - done
      - when: <% failed() %>
        publish:
          - result: "{{ result() }}"
        do:
          - failed 
  